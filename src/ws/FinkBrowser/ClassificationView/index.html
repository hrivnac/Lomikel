<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Neighborhood Visualization</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    </head>
  <body>
    <button id="help-btn">?</button>
    <!-- Help modal -->
    <div id="help-modal" class="modal">
      <div class="modal-content">
        <span id="close-help" class="close">&times;</span>
        <h2>Help</h2>
        <p>Application shows classification-based neigborhood (i.e. other objects with similar classification)
           for any object of ZTF or LSST. User can choose:
           <ul>
             <li><b>Object ID</b> of requested object from either ZTF or LSST.</li>
             <li><b>Classifier</b> used to classify objects.
                 <ul>
                   <li><b>FINK</b> is based on the FINK classiofication.</li>
                   <li><b>XMATCH</b> is based on other classifications aquired via FINK.</li>
                   <li><b>FEATURES</b> uses classification based on PCA and clusterring of alerts physical properties.</li>
                   <li><b>LIGHTCURVES</b> uses learned properties of objects light curves.</li>
                   <li><b>TAG</b> is using user-supplied selections.</li>
                   </ul>
               </li>
             <li><b>Re-Classifier</b> can re-interpred classification by another Classifier. 
                 <ul>
                   <li><b>none</b> doesn't re-interpret.</li>
                   </ul>
               </li>
             <li><b>Algorithm</b> (measure) to calculate distances between objects in the space of classifications.</li>
             <li><b>nmax</b> - the maximal number of closest objects to show. If less than 1, the number of objects
                               to show is calculated via differences in distances between subsequent objects
                               (smaller numbers is less selective). 0 gives all close objects.</li>
             </ul>
           Double-click on an object (represented by blue star) triggers the search centered on that object.
           Objects pop-up shows classification details and allows to navigate to Fink Portal of concerned object.
           If data loading fails, the demo data are shown.
           </p>
        </div>
      </div> 
    <!-- Details panel -->
    <div id="detailsPanel" class="panel">
      <h3>Visible Objects</h3>
      <div id="objectList">No objects loaded</div>
      </div>
    <!-- Movable controls panel -->
    <div id="controls" class="draggable">
      <div id="panel-header">Neighborhood Parameters</div>
      <div id="panel-body">
        <label>Object ID:
          <input type="text" id="objectId" value="ZTF18adjxitr">
          </label>
        <br>  
        <label>Classifier:
          <select id="classifier">
            <option value="FINK">FINK</option>
            <option value="XMATCH" selected>XMATCH</option>
            <option value="FEATURES=2025/13-50">FEATURES 2025/13-50</option>
            <option value="FEATURES=2025/13-60">FEATURES 2025/13-60</option>
            <option value="LIGHTCURVES">LIGHTCURVES</option>
            <option value="TAG">TAG</option>
            </select>
          </label>
        <br>  
        <label>Re-Classifier:
          <select id="reclassifier">
            <option value="none" selected>none</option>
            <option value="FINK">FINK</option>
            <option value="XMATCH">XMATCH</option>
            <option value="FEATURES=2025/13-50">FEATURES 2025/13-50</option>
            <option value="FEATURES=2025/13-60">FEATURES 2025/13-60</option>
            <option value="LIGHTCURVES">LIGHTCURVES</option>
            <option value="TAG">TAG</option>
            </select>
          </label>
        <br>  
        <label>Algorithm:
          <select id="alg">
            <option value="JensenShannon" selected>JensenShannon</option>
            <option value="Euclidean">Euclidean</option>
            <option value="Cosine">Cosine</option>
            </select>
          </label>
        <br>  
        <!-- slider range remains 0..1 but initial value set to 0.25 so displayed nmax = 0.5 -->
        <label>nmax:
          <input type="range" id="nmax" min="0" max="1" step="0.001" value="0.25">
          <span id="nmaxValue">0.5</span>
          </label>
        <br>  
        <button id="showBtn">Show</button>
        </div>
      </div>
    <!-- Tooltip and Viz -->
    <div id="tooltip"></div>
    <div id="viz"></div>
    <button id="resetBtn">Reset Zoom</button>  
    <!-- Loading spinner -->
    <div id="loading-spinner" class="spinner-overlay">
      <div id="spinner-wheel" class="spinner"></div>
      </div> 
    <script src="data.js"></script>
    <script src="overlaps.js"></script>
    <script src="drawing.js"></script>
    <script src="menu.js"></script>
    <script src="list.js"></script>
    <script src="help.js"></script>
    <script src="spinner.js"></script>
    <script src="app.js"></script>
    </body>
  </html>
  